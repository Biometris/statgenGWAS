<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Plot function for the class <code>GWAS</code> — plot.GWAS • statgenGWAS</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Plot function for the class <code>GWAS</code> — plot.GWAS" />
<meta property="og:description" content="Creates a plot of an object of S3 class GWAS. The following types of
plot can be made:
a manhattan plot, i.e. a plot of LOD-scores per SNP
a QQ plot of observed LOD-scores versus expected LOD-scores
a qtl plot of effect sizes and directions for multiple traits
Manhattan plots and QQ plots are made for a single trait which
should be indicated using the parameter trait. If the analysis was
done for only one trait, it is detected automatically. The qtl plot will plot
all traits analyzed.
See details for a detailed description of the plots and the plot options
specific to the different plots." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">statgenGWAS</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.4.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../news/index.html">
    <span class="fa fa-newspaper-o"></span>
     
    news
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    functions
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-seedling"></span>
     
    other packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="https://biometris.github.io/statgenSTA">statgenSTA</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://github.com/Biometris/statgenGWAS">
    <span class="fa fa-github fa-lg"></span>
     
    github
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Plot function for the class <code>GWAS</code></h1>
    <small class="dont-index">Source: <a href='https://github.com/Biometris/statgenGWAS/blob/master/R/createGWAS.R'><code>R/createGWAS.R</code></a></small>
    <div class="hidden name"><code>plot.GWAS.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Creates a plot of an object of S3 class <code>GWAS</code>. The following types of
plot can be made:</p><ul>
<li><p>a manhattan plot, i.e. a plot of LOD-scores per SNP</p></li>
<li><p>a QQ plot of observed LOD-scores versus expected LOD-scores</p></li>
<li><p>a qtl plot of effect sizes and directions for multiple traits</p></li>
</ul><p>Manhattan plots and QQ plots are made for a single trait which
should be indicated using the parameter <code>trait</code>. If the analysis was
done for only one trait, it is detected automatically. The qtl plot will plot
all traits analyzed.<br />
See details for a detailed description of the plots and the plot options
specific to the different plots.</p>
    </div>

    <pre class="usage"><span class='co'># S3 method for GWAS</span>
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(
  <span class='no'>x</span>,
  <span class='no'>...</span>,
  <span class='kw'>plotType</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"manhattan"</span>, <span class='st'>"qq"</span>, <span class='st'>"qtl"</span>),
  <span class='kw'>trial</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>trait</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>output</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>An object of class <code>GWAS</code>.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>further arguments to be passed on to the actual plotting
functions.</p></td>
    </tr>
    <tr>
      <th>plotType</th>
      <td><p>A character string indicating the type of plot to be made.
One of "manhattan", "qq" and "qtl".</p></td>
    </tr>
    <tr>
      <th>trial</th>
      <td><p>A character string or numeric index indicating for which
trial the plot should be made. If <code>x</code> only contains results for
one trial, <code>trial</code> may be <code>NULL</code>.</p></td>
    </tr>
    <tr>
      <th>trait</th>
      <td><p>A character string indicating for which trait the results
should be plotted. For <code>type</code> "qtl" all traits are plotted. If <code>x</code>
only contains results for one trait, <code>trait</code> may be <code>NULL</code>.</p></td>
    </tr>
    <tr>
      <th>output</th>
      <td><p>Should the plot be output to the current device? If
<code>FALSE</code>, only a list of ggplot objects is invisibly returned.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="manhattan-plot"><a class="anchor" href="#manhattan-plot"></a>Manhattan Plot</h2>

    

<p>A LOD-profile of all marker positions and corresponding LOD-scores is
plotted. Significant markers are highlighted with red dots. By default these
are taken from the result of the GWAS analysis however the LOD-threshold for
significant parameters may be modified using the parameter <code>yThr</code>. The
threshold is plotted as a horizontal line. If there are previously known
marker effect, false positives and true negatives can also be marked.<br />
Extra parameter options:</p><dl'>
<dt><code>xLab</code></dt><dd><p>A character string, the x-axis label. Default =
<code>"Chromosomes"</code></p></dd>
<dt><code>yLab</code></dt><dd><p>A character string, the y-axis label. Default =
<code>-log10(p)</code></p></dd>
<dt><code>effects</code></dt><dd><p>A character vector, indicating which SNPs correspond
to a real (known) effect. Used for determining true/false positives and
false negatives. True positives are colored green, false positives orange and
false negatives yellow.</p></dd>
<dt><code>colPalette</code></dt><dd><p>A color palette used for plotting. Default
coloring is done by chromosome, using black and grey.</p></dd>
<dt><code>yThr</code></dt><dd><p>A numerical value for the LOD-threshold. The value from
the GWAS analysis is used as default.</p></dd>
<dt><code>signLwd</code></dt><dd><p>A numerical value giving the thickness of the
points that are false/true positives/negatives. Default = 0.6</p></dd>
<dt><code>lod</code></dt><dd><p>A positive numerical value. For the SNPs with a LOD-value
below this value, only 5% is plotted. The chance of a SNP being plotted is
proportional to its LOD-score. This option can be useful when plotting a
large number of SNPs. The 5% of SNPs plotted is selected randomly. For 
reproducible results use set.seed before calling the function.</p></dd>
<dt><code>chr</code></dt><dd><p>A vector of chromosomes to be plotted. By default, all
chromosomes are plotted. Using this option allows restricting the plot to a
subset of chromosomes.</p></dd>

</dl>

    <h2 class="hasAnchor" id="qq-plot"><a class="anchor" href="#qq-plot"></a>QQ-Plot</h2>

    

<p>From the LOD-scores calculated in the GWAS analysis, a QQ-plot is generated 
with observed LOD-scores versus expected LOD-scores. Code is adapted from
Segura et al. (2012).</p>
    <h2 class="hasAnchor" id="qtl-plot"><a class="anchor" href="#qtl-plot"></a>QTL Plot</h2>

    

<p>A plot of effect sizes for the significant SNPs found in the GWAS analysis
is created. Each horizontal line contains QTLs of one trait,
phenotypic trait or trial. Optionally, vertical white lines can indicate
chromosome subdivision, genes of interest, known QTL, etc. Circle diameters
are proportional to the absolute value of allelic effect. Colors indicate the
direction of the effect: green when the allele increases the trait value,
and blue when it decreases the value.<br />
Extra parameter options:</p><dl'>
<dt><code>normalize</code></dt><dd><p>Should the snpEffect be normalized? Default =
<code>FALSE</code></p></dd>
<dt><code>sortData</code></dt><dd><p>Should the data be sorted before plotting? Either
<code>FALSE</code>, if no sorting should be done, or a character string indicating
the data column to use for sorting. This should be a numerical column.
Default = <code>FALSE</code></p></dd>
<dt><code>binPositions</code></dt><dd><p>An optional data.frame containing at leasts two
columns, chr(omosome) and pos(ition). Vertical lines are plotted at those
positions. Default = <code>NULL</code></p></dd>
<dt><code>printVertGrid</code></dt><dd><p>Should default vertical grid lines be plotted.
Default = <code>TRUE</code></p></dd>
<dt><code>yLab</code></dt><dd><p>A character string, the y-axis label. Default =
<code>"Traits"</code></p></dd>
<dt><code>yThr</code></dt><dd><p>A numerical value for the LOD-threshold. The value from
the GWAS analysis is used as default.</p></dd>
<dt><code>chr</code></dt><dd><p>A vector of chromosomes to be plotted. By default all
chromosomes are plotted. Using this option this can be restricted to a
subset of chromosomes.</p></dd>
<dt><code>exportPptx</code></dt><dd><p>Should the plot be exported to a .pptx file?
Default = <code>FALSE</code></p></dd>
<dt><code>pptxName</code></dt><dd><p>A character string, the name of the .pptx file to
which the plot is exported. Ignored if exportPptx = <code>FALSE</code>.</p></dd>

</dl>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Millet et al. (2016) Genome-wide analysis of yield in Europe:
Allelic effects vary with drought and heat scenarios. Plant Physiology,
October 2016, Vol. 172, p. 749–764</p>
<p>Segura et al. (2012) An efficient multi-locus mixed-model
approach for genome-wide association studies in structured populations.
Nature Genetics, June 2012, Vol. 44, p. 825–830.</p>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Bart-Jan van Rossum, Willem Kruijer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


