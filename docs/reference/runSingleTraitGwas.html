<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Perform single-trait GWAS — runSingleTraitGwas • statgenGWAS</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Perform single-trait GWAS — runSingleTraitGwas" />
<meta property="og:description" content="runSingleTraitGwas performs a single-trait Genome Wide Association
Study (GWAS) on phenotypic and genotypic data contained in a gData
object. A covariance matrix is computed using the EMMA algorithm (Kang et
al., 2008) or the Newton-Raphson algorithm (Tunnicliffe, 1989) in the
sommer package. Then a Generalized Least Squares (GLS) method is used
for estimating the marker effects and corresponding p-values. This is done
using either one kinship matrix for all chromosomes or different 
chromosome-specific kinship matrices for each chromosome. Significant SNPs 
are selected based on a user defined threshold." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">statgenGWAS</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.4.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../news/index.html">
    <span class="fa fa-newspaper-o"></span>
     
    news
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    functions
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-seedling"></span>
     
    other packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="https://biometris.github.io/statgenSTA">statgenSTA</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://github.com/Biometris/statgenGWAS">
    <span class="fa fa-github fa-lg"></span>
     
    github
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Perform single-trait GWAS</h1>
    <small class="dont-index">Source: <a href='https://github.com/Biometris/statgenGWAS/blob/master/R/runSingleTraitGwas.R'><code>R/runSingleTraitGwas.R</code></a></small>
    <div class="hidden name"><code>runSingleTraitGwas.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>runSingleTraitGwas</code> performs a single-trait Genome Wide Association
Study (GWAS) on phenotypic and genotypic data contained in a <code>gData</code>
object. A covariance matrix is computed using the EMMA algorithm (Kang et
al., 2008) or the Newton-Raphson algorithm (Tunnicliffe, 1989) in the
<code>sommer</code> package. Then a Generalized Least Squares (GLS) method is used
for estimating the marker effects and corresponding p-values. This is done
using either one kinship matrix for all chromosomes or different 
chromosome-specific kinship matrices for each chromosome. Significant SNPs 
are selected based on a user defined threshold.</p>
    </div>

    <pre class="usage"><span class='fu'>runSingleTraitGwas</span>(
  <span class='no'>gData</span>,
  <span class='kw'>traits</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>trials</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>covar</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>snpCov</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>kin</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>kinshipMethod</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"astle"</span>, <span class='st'>"IBS"</span>, <span class='st'>"vanRaden"</span>),
  <span class='kw'>remlAlgo</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"EMMA"</span>, <span class='st'>"NR"</span>),
  <span class='kw'>GLSMethod</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"single"</span>, <span class='st'>"multi"</span>),
  <span class='kw'>useMAF</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>MAF</span> <span class='kw'>=</span> <span class='fl'>0.01</span>,
  <span class='kw'>MAC</span> <span class='kw'>=</span> <span class='fl'>10</span>,
  <span class='kw'>genomicControl</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>thrType</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"bonf"</span>, <span class='st'>"fixed"</span>, <span class='st'>"small"</span>, <span class='st'>"fdr"</span>),
  <span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>0.05</span>,
  <span class='kw'>LODThr</span> <span class='kw'>=</span> <span class='fl'>4</span>,
  <span class='kw'>nSnpLOD</span> <span class='kw'>=</span> <span class='fl'>10</span>,
  <span class='kw'>pThr</span> <span class='kw'>=</span> <span class='fl'>0.05</span>,
  <span class='kw'>rho</span> <span class='kw'>=</span> <span class='fl'>0.5</span>,
  <span class='kw'>sizeInclRegion</span> <span class='kw'>=</span> <span class='fl'>0</span>,
  <span class='kw'>minR2</span> <span class='kw'>=</span> <span class='fl'>0.5</span>,
  <span class='kw'>nCores</span> <span class='kw'>=</span> <span class='kw'>NULL</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>gData</th>
      <td><p>An object of class <code>gData</code> containing at least <code>map</code>,
<code>markers</code> and <code>pheno</code>.</p></td>
    </tr>
    <tr>
      <th>traits</th>
      <td><p>A vector of traits on which to run GWAS. These can be either
numeric indices or character names of columns in <code>pheno</code>. If <code>NULL</code>,
GWAS is run on all traits.</p></td>
    </tr>
    <tr>
      <th>trials</th>
      <td><p>A vector of trials on which to run GWAS. These can
be either numeric indices or character names of list items in <code>pheno</code>.
If <code>NULL</code>, GWAS is run for all trials. GWAS is run for the
selected trials in sequential order.</p></td>
    </tr>
    <tr>
      <th>covar</th>
      <td><p>An optional vector of covariates taken into account when
running GWAS. These can be either numeric indices or character names of
columns in <code>covar</code> in <code>gData</code>. If <code>NULL</code> no covariates are
used.</p></td>
    </tr>
    <tr>
      <th>snpCov</th>
      <td><p>An optional character vector of snps to be included as
covariates.</p></td>
    </tr>
    <tr>
      <th>kin</th>
      <td><p>An optional kinship matrix or list of kinship matrices. These
matrices can be from the <code>matrix</code> class as defined in the base package
or from the <code>dsyMatrix</code> class, the class of symmetric matrices in the
Matrix package.<br />
If <code>GLSMethod</code> = "single" then one matrix should be provided, if
<code>GLSMethod</code> = "multi", a list of chromosome specific matrices of length
equal to the number of chromosomes in <code>map</code> in <code>gData</code>.<br />
If <code>NULL</code> then matrix <code>kinship</code> in <code>gData</code> is used. <br />
If both <code>kin</code> is provided and <code>gData</code> contains a matrix
<code>kinship</code> then <code>kin</code> is used.</p></td>
    </tr>
    <tr>
      <th>kinshipMethod</th>
      <td><p>An optional character indicating the method used for
calculating the kinship matrix(ces). Currently "astle" (Astle and Balding,
2009), "IBS" and "vanRaden" (VanRaden, 2008) are supported. If a
kinship matrix is supplied either in <code>gData</code> or in parameter <code>kin</code>,
<code>kinshipMethod</code> is ignored.</p></td>
    </tr>
    <tr>
      <th>remlAlgo</th>
      <td><p>A character string indicating the algorithm used to estimate
the variance components. Either <code>EMMA</code>, for the EMMA algorithm, or
<code>NR</code>, for the Newton-Raphson algorithm.</p></td>
    </tr>
    <tr>
      <th>GLSMethod</th>
      <td><p>A character string indicating the method used to estimate
the marker effects. Either <code>single</code> for using a single kinship matrix,
or <code>multi</code> for using chromosome specific kinship matrices.</p></td>
    </tr>
    <tr>
      <th>useMAF</th>
      <td><p>Should the minor allele frequency be used for selecting SNPs
for the analysis. If <code>FALSE</code>, the minor allele count is used instead.</p></td>
    </tr>
    <tr>
      <th>MAF</th>
      <td><p>The minor allele frequency (MAF) threshold used in GWAS. A
numerical value between 0 and 1. SNPs with MAF below this value are not taken
into account in the analysis, i.e. p-values and effect sizes are put to
missing (<code>NA</code>). Ignored if <code>useMAF</code> is <code>FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>MAC</th>
      <td><p>A numerical value. SNPs with minor allele count below this value
are not taken into account for the analysis, i.e. p-values and effect sizes
are set to missing (<code>NA</code>). Ignored if <code>useMAF</code> is <code>TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>genomicControl</th>
      <td><p>Should genomic control correction as in Devlin and
Roeder (1999) be applied?</p></td>
    </tr>
    <tr>
      <th>thrType</th>
      <td><p>A character string indicating the type of threshold used for
the selection of candidate loci. See Details.</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>A numerical value used for calculating the LOD-threshold for
<code>thrType</code> = "bonf" and the significant p-Values for <code>thrType</code> = 
"fdr".</p></td>
    </tr>
    <tr>
      <th>LODThr</th>
      <td><p>A numerical value used as a LOD-threshold when
<code>thrType</code> = "fixed".</p></td>
    </tr>
    <tr>
      <th>nSnpLOD</th>
      <td><p>A numerical value indicating the number of SNPs with the
smallest p-values that are selected when <code>thrType</code> = "small".</p></td>
    </tr>
    <tr>
      <th>pThr</th>
      <td><p>A numerical value just as the cut off value for p-Values for 
<code>thrType</code> = "fdr".</p></td>
    </tr>
    <tr>
      <th>rho</th>
      <td><p>A numerical value used a the minimum value for SNPs to be 
considered correlated when using <code>thrType</code> = "fdr".</p></td>
    </tr>
    <tr>
      <th>sizeInclRegion</th>
      <td><p>An integer. Should the results for SNPs close to
significant SNPs be included? If so, the size of the region in centimorgan
or base pairs. Otherwise 0.</p></td>
    </tr>
    <tr>
      <th>minR2</th>
      <td><p>A numerical value between 0 and 1. Restricts the SNPs included
in the region close to significant SNPs to only those SNPs that are in
sufficient Linkage Disequilibrium (LD) with the significant snp, where LD
is measured in terms of \(R^2\). If for example <code>sizeInclRegion</code> = 
200000 and <code>minR2</code> = 0.5, then for every significant SNP also those SNPs 
whose LD (\(R^2\)) with the significant SNP is at least 0.5 AND which are 
at most 200000 away from this significant snp are included. Ignored if
<code>sizeInclRegion</code> = 0.</p></td>
    </tr>
    <tr>
      <th>nCores</th>
      <td><p>A numerical value indicating the number of cores to be used by
the parallel part of the algorithm. If <code>NULL</code> the number of cores used
will be equal to the number of cores available on the machine - 1.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class <code>GWAS</code>.</p>
    <h2 class="hasAnchor" id="threshold-types-for-the-selection-of-candidate-loci"><a class="anchor" href="#threshold-types-for-the-selection-of-candidate-loci"></a>Threshold types for the selection of candidate loci</h2>

    

<p>For the selection of candidate loci from the GWAS output four different 
methods can be used. The method used can be specified in the function 
parameter <code>thrType</code>. Further parameters can be used to fine tune the 
method.</p><dl'>
<dt>bonf</dt><dd><p>The Bonferroni threshold, a LOD-threshold of 
\(-log10(alpha / m)\), where m is the number of SNPs and alpha can be 
specified by the function parameter <code>alpha</code></p></dd>
<dt>fixed</dt><dd><p>A fixed LOD-threshold, specified by the function parameter
<code>LODThr</code></p></dd>
<dt>small</dt><dd><p>The n SNPs with with the smallest p-Values are selected. n can
be specified in <code>nSnpLOD</code></p></dd>
<dt>fdr</dt><dd><p>Following the algorithm proposed by Brzyski D. et al. (2017), 
SNPs are selected in such a way that the False Discovery Rate (fdr) is 
minimized. To do this, first the SNPs are restricted to the SNPs with a 
p-Value below <code>pThr</code>. Then clusters of SNPs are created using a 
two step iterative process in which first the SNP with the lowest p-Value is 
selected as cluster representative. This SNP and all SNPs that have a 
correlation with this SNP of <code>pho</code> or higher will form a cluster. 
The selected SNPs are removed from the list and the procedure repeated until 
no SNPs are left. Finally to determine the number of significant clusters 
the first cluster is determined for which the p-Value of the cluster 
representative is not smaller than \(cluster_{number} * alpha / m\) where 
m is the number of SNPs and alpha can be specified by the function parameter 
<code>alpha</code>. All previous clusters are selected as significant.</p></dd>

</dl>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Astle, William, and David J. Balding. 2009. Population Structure
and Cryptic Relatedness in Genetic Association Studies. Statistical Science 
24 (4): 451–71. <a href='https://doi.org/10.1214/09-sts307'>https://doi.org/10.1214/09-sts307</a>.</p>
<p>Brzyski D. et al. (2017) Controlling the Rate of GWAS False 
Discoveries. Genetics 205 (1): 61-75.
<a href='https://doi.org/10.1534/genetics.116.193987'>https://doi.org/10.1534/genetics.116.193987</a></p>
<p>Devlin, B., and Kathryn Roeder. 1999. Genomic Control for 
Association Studies. Biometrics 55 (4): 997–1004. 
<a href='https://doi.org/10.1111/j.0006-341x.1999.00997.x'>https://doi.org/10.1111/j.0006-341x.1999.00997.x</a>.</p>
<p>Kang et al. (2008) Efficient Control of Population Structure in
Model Organism Association Mapping. Genetics 178 (3): 1709–23. 
<a href='https://doi.org/10.1534/genetics.107.080101'>https://doi.org/10.1534/genetics.107.080101</a>.</p>
<p>Millet, E. J., Pommier, C., et al. (2019). A multi-site 
experiment in a network of European fields for assessing the maize yield 
response to environmental scenarios [Data set]. 
<a href='https://doi.org/10.15454/IASSTN'>https://doi.org/10.15454/IASSTN</a></p>
<p>Rincent et al. (2014) Recovering power in association mapping
panels with variable levels of linkage disequilibrium. Genetics 197 (1): 
375–87. <a href='https://doi.org/10.1534/genetics.113.159731'>https://doi.org/10.1534/genetics.113.159731</a>.</p>
<p>Segura et al. (2012) An efficient multi-locus mixed-model
approach for genome-wide association studies in structured populations.
Nature Genetics 44 (7): 825–30. <a href='https://doi.org/10.1038/ng.2314'>https://doi.org/10.1038/ng.2314</a>.</p>
<p>Sun et al. (2010) Variation explained in mixed-model association
mapping. Heredity 105 (4): 333–40. <a href='https://doi.org/10.1038/hdy.2010.11'>https://doi.org/10.1038/hdy.2010.11</a>.</p>
<p>Tunnicliffe W. (1989) On the use of marginal likelihood in time
series model estimation. JRSS 51 (1): 15–27.</p>
<p>VanRaden P.M. (2008) Efficient methods to compute genomic
predictions. Journal of Dairy Science 91 (11): 4414–23. 
<a href='https://doi.org/10.3168/jds.2007-0980'>https://doi.org/10.3168/jds.2007-0980</a>.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='summary.GWAS.html'>summary.GWAS</a></code>, <code><a href='plot.GWAS.html'>plot.GWAS</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>## Create a gData object Using the data from the DROPS project.</span>
<span class='co'>## See the included vignette for a more extensive description on the steps.</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>dropsMarkers</span>)
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>dropsMap</span>)
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>dropsPheno</span>)
<span class='co'>## Add genotypes as row names of dropsMarkers and drop Ind column.</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span>(<span class='no'>dropsMarkers</span>) <span class='kw'>&lt;-</span> <span class='no'>dropsMarkers</span><span class='kw'>[[</span><span class='st'>"Ind"</span>]]
<span class='no'>dropsMarkers</span> <span class='kw'>&lt;-</span> <span class='no'>dropsMarkers</span>[<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='no'>dropsMarkers</span>) <span class='kw'>!=</span> <span class='st'>"Ind"</span>]
<span class='co'>## Add genotypes as row names of dropsMap.</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span>(<span class='no'>dropsMap</span>) <span class='kw'>&lt;-</span> <span class='no'>dropsMap</span><span class='kw'>[[</span><span class='st'>"SNP.names"</span>]]
<span class='co'>## Rename Chomosome and Position columns.</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='no'>dropsMap</span>)[<span class='fu'><a href='https://rdrr.io/r/base/match.html'>match</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"Chromosome"</span>, <span class='st'>"Position"</span>),
                   <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='no'>dropsMap</span>))] <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"chr"</span>, <span class='st'>"pos"</span>)
<span class='co'>## Convert phenotypic data to a list.</span>
<span class='no'>dropsPhenoList</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/split.html'>split</a></span>(<span class='kw'>x</span> <span class='kw'>=</span> <span class='no'>dropsPheno</span>, <span class='kw'>f</span> <span class='kw'>=</span> <span class='no'>dropsPheno</span><span class='kw'>[[</span><span class='st'>"Experiment"</span>]])
<span class='co'>## Rename Variety_ID to genotype and select relevant columns.</span>
<span class='no'>dropsPhenoList</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span>(<span class='kw'>X</span> <span class='kw'>=</span> <span class='no'>dropsPhenoList</span>, <span class='kw'>FUN</span> <span class='kw'>=</span> <span class='kw'>function</span>(<span class='no'>trial</span>) {
  <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='no'>trial</span>)[<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='no'>trial</span>) <span class='kw'>==</span> <span class='st'>"Variety_ID"</span>] <span class='kw'>&lt;-</span> <span class='st'>"genotype"</span>
  <span class='no'>trial</span> <span class='kw'>&lt;-</span> <span class='no'>trial</span>[<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"genotype"</span>, <span class='st'>"grain.yield"</span>, <span class='st'>"grain.number"</span>, <span class='st'>"seed.size"</span>,
                 <span class='st'>"anthesis"</span>, <span class='st'>"silking"</span>, <span class='st'>"plant.height"</span>, <span class='st'>"tassel.height"</span>,
                 <span class='st'>"ear.height"</span>)]
<span class='fu'><a href='https://rdrr.io/r/base/function.html'>return</a></span>(<span class='no'>trial</span>)
})
<span class='no'>gDataDrops</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='gData.html'>createGData</a></span>(<span class='kw'>geno</span> <span class='kw'>=</span> <span class='no'>dropsMarkers</span>, <span class='kw'>map</span> <span class='kw'>=</span> <span class='no'>dropsMap</span>,
                          <span class='kw'>pheno</span> <span class='kw'>=</span> <span class='no'>dropsPhenoList</span>)

<span class='co'>## Run single trait GWAS for trait 'grain.yield' for trial Mur13W.</span>
<span class='co'># \donttest{</span>
<span class='no'>GWASDrops</span> <span class='kw'>&lt;-</span> <span class='fu'>runSingleTraitGwas</span>(<span class='kw'>gData</span> <span class='kw'>=</span> <span class='no'>gDataDrops</span>,
                               <span class='kw'>trials</span> <span class='kw'>=</span> <span class='st'>"Mur13W"</span>,
                               <span class='kw'>traits</span> <span class='kw'>=</span> <span class='st'>"grain.yield"</span>)
<span class='co'># }</span>

<span class='co'>## Run single trait GWAS for trait 'grain.yield' for trial Mur13W.</span>
<span class='co'>## Use chromosome specific kinship matrices calculated using vanRaden method.</span>
<span class='co'># \donttest{</span>
<span class='no'>GWASDropsMult</span> <span class='kw'>&lt;-</span> <span class='fu'>runSingleTraitGwas</span>(<span class='kw'>gData</span> <span class='kw'>=</span> <span class='no'>gDataDrops</span>,
                                    <span class='kw'>trials</span> <span class='kw'>=</span> <span class='st'>"Mur13W"</span>,
                                    <span class='kw'>traits</span> <span class='kw'>=</span> <span class='st'>"grain.yield"</span>,
                                    <span class='kw'>kinshipMethod</span> <span class='kw'>=</span> <span class='st'>"vanRaden"</span>,
                                    <span class='kw'>GLSMethod</span> <span class='kw'>=</span> <span class='st'>"multi"</span>)
<span class='co'># }</span></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Bart-Jan van Rossum, Willem Kruijer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


