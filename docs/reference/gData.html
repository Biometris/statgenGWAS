<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>S3 Class gData — gData • statgenGWAS</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="S3 Class gData — gData" />
<meta property="og:description" content="createGData creates an object of S3 class gData with genotypic and
phenotypic data for usage in further analysis. All input to the function is
optional, however at least one input should be provided. It is possible to
provide an existing gData object as additional input in which case
data is added to this object. Existing data will be overwritten with a
warning." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">statgenGWAS</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.4.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../news/index.html">
    <span class="fa fa-newspaper-o"></span>
     
    news
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    functions
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-seedling"></span>
     
    other packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="https://biometris.github.io/statgenSTA">statgenSTA</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://github.com/Biometris/statgenGWAS">
    <span class="fa fa-github fa-lg"></span>
     
    github
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>S3 Class gData</h1>
    <small class="dont-index">Source: <a href='https://github.com/Biometris/statgenGWAS/blob/master/R/createGData.R'><code>R/createGData.R</code></a></small>
    <div class="hidden name"><code>gData.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>createGData</code> creates an object of S3 class gData with genotypic and
phenotypic data for usage in further analysis. All input to the function is
optional, however at least one input should be provided. It is possible to
provide an existing <code>gData</code> object as additional input in which case
data is added to this object. Existing data will be overwritten with a
warning.</p>
    </div>

    <pre class="usage"><span class='fu'>createGData</span>(
  <span class='kw'>gData</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>geno</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>map</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>kin</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>pheno</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>covar</span> <span class='kw'>=</span> <span class='kw'>NULL</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>gData</th>
      <td><p>An optional gData object to be modified. If <code>NULL</code>, a new
gData object is created.</p></td>
    </tr>
    <tr>
      <th>geno</th>
      <td><p>A matrix or data.frame with genotypes in the rows and markers in
the columns. A matrix from the <code>matrix</code> in the base package may be
provided as well as as matrix from the Matrix package.<br />
If no row names are provided, they are taken from <code>pheno</code> (if supplied 
and dimension matches). If no column names are provided, the row names
from <code>map</code> are used (if supplied and dimension matches).</p></td>
    </tr>
    <tr>
      <th>map</th>
      <td><p>A data.frame with columns <code>chr</code> for chromosome and
<code>pos</code> for position. Positions can be in base pair (bp) or centimorgan (cM). They
should not be cumulative over the chromosomes. Other columns are ignored.
Marker names should be in the row names. These should match the marker names
in <code>geno</code> (if supplied).</p></td>
    </tr>
    <tr>
      <th>kin</th>
      <td><p>A kinship matrix or list of kinship matrices with genotype in
rows and colums. These matrices can be from the <code>matrix</code> class, as
defined in the base package, or from the <code>dsyMatrix</code> class, the class
of symmetric matrices in the Matrix package.<br />
The genotypes should be identical to the genotypes in <code>geno</code>.<br />
If a list of kinship matrices is provided these are supposed to be
chromosome specific matrices. In that case their names should match
the names of the chromosomes in <code>map</code>. If no names are
provided, the number of matrices should match the number of chromosomes
in <code>map</code> in which case default names are provided.</p></td>
    </tr>
    <tr>
      <th>pheno</th>
      <td><p>A data.frame or a list of data.frames with phenotypic data,
with genotypes in the first column <code>genotype</code> and traits in the
following columns. The trait columns should be numerical columns only.
A list of data.frames can be used for replications, i.e. different
trials.</p></td>
    </tr>
    <tr>
      <th>covar</th>
      <td><p>A data.frame with extra covariates per genotype. Genotypes
should be in the rows.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class <code>gData</code> with the following components:</p>
<dt><code>map</code></dt><dd><p>a data.frame containing map data. Map is sorted by
chromosome and position.</p></dd>
<dt><code>markers</code></dt><dd><p>a matrix containing marker information.</p></dd>
<dt><code>pheno</code></dt><dd><p>a list of data.frames containing phenotypic data.</p></dd>
<dt><code>kinship</code></dt><dd><p>a kinship matrix.</p></dd>
<dt><code>covar</code></dt><dd><p>a data.frame with extra covariates.</p></dd>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='summary.gData.html'>summary.gData</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>1234</span>)
<span class='co'>## Create genotypic data.</span>
<span class='no'>geno</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span>(<span class='kw'>x</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>2</span>), <span class='kw'>size</span> <span class='kw'>=</span> <span class='fl'>15</span>, <span class='kw'>replace</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>), <span class='kw'>nrow</span> <span class='kw'>=</span> <span class='fl'>3</span>)
<span class='fu'><a href='https://rdrr.io/r/base/dimnames.html'>dimnames</a></span>(<span class='no'>geno</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span>(<span class='st'>"G"</span>, <span class='fl'>1</span>:<span class='fl'>3</span>), <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span>(<span class='st'>"M"</span>, <span class='fl'>1</span>:<span class='fl'>5</span>))

<span class='co'>## Construct map.</span>
<span class='no'>map</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>(<span class='kw'>chr</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>, <span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>2</span>, <span class='fl'>2</span>), <span class='kw'>pos</span> <span class='kw'>=</span> <span class='fl'>1</span>:<span class='fl'>5</span>,
                  <span class='kw'>row.names</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span>(<span class='st'>"M"</span>, <span class='fl'>1</span>:<span class='fl'>5</span>))

<span class='co'>## Compute kinship matrix.</span>
<span class='no'>kin</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='kinship.html'>kinship</a></span>(<span class='kw'>X</span> <span class='kw'>=</span> <span class='no'>geno</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"IBS"</span>)

<span class='co'>## Create phenotypic data.</span>
<span class='no'>pheno</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span>(<span class='st'>"G"</span>, <span class='fl'>1</span>:<span class='fl'>3</span>),
                    <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>12</span>, <span class='kw'>mean</span> <span class='kw'>=</span> <span class='fl'>50</span>, <span class='kw'>sd</span> <span class='kw'>=</span> <span class='fl'>5</span>), <span class='kw'>nrow</span> <span class='kw'>=</span> <span class='fl'>3</span>),
                    <span class='kw'>stringsAsFactors</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)
<span class='fu'><a href='https://rdrr.io/r/base/dimnames.html'>dimnames</a></span>(<span class='no'>pheno</span>) <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span>(<span class='st'>"G"</span>, <span class='fl'>1</span>:<span class='fl'>3</span>), <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"genotype"</span>, <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span>(<span class='st'>"T"</span>, <span class='fl'>1</span>:<span class='fl'>4</span>)))

<span class='co'>## Combine all data in gData object.</span>
<span class='no'>gData</span> <span class='kw'>&lt;-</span> <span class='fu'>createGData</span>(<span class='kw'>geno</span> <span class='kw'>=</span> <span class='no'>geno</span>, <span class='kw'>map</span> <span class='kw'>=</span> <span class='no'>map</span>, <span class='kw'>kin</span> <span class='kw'>=</span> <span class='no'>kin</span>, <span class='kw'>pheno</span> <span class='kw'>=</span> <span class='no'>pheno</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>gData</span>)</div><div class='output co'>#&gt; map
#&gt; 	Number of markers: 5 
#&gt; 	Number of chromosomes: 2 
#&gt; 
#&gt; markers
#&gt; 	Number of markers: 5 
#&gt; 	Number of genotypes: 3 
#&gt; 	Content:
#&gt; 	 0 1 2 NA 
#&gt; 	 0.2 0.6 0.2 0 
#&gt; 
#&gt; pheno
#&gt; 	Number of trials: 1 
#&gt; 
#&gt; 	pheno:
#&gt; 		Number of traits: 4 
#&gt; 		Number of genotypes: 3 
#&gt; 
#&gt;               T1       T2       T3       T4
#&gt; Min.    41.24633 41.56337 46.76490 51.55131
#&gt; 1st Qu. 44.33149 44.21309 48.42824 51.71474
#&gt; Median  47.41665 46.86282 50.09158 51.87818
#&gt; Mean    47.68783 48.42541 50.12757 52.59013
#&gt; 3rd Qu. 50.90859 51.85644 51.80890 53.10954
#&gt; Max.    54.40052 56.85005 53.52622 54.34090
#&gt; NA's     0.00000  0.00000  0.00000  0.00000
#&gt; </div><div class='input'>
<span class='co'>## Construct covariate.</span>
<span class='no'>covar</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>(<span class='kw'>C1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"a"</span>, <span class='st'>"a"</span>, <span class='st'>"b"</span>), <span class='kw'>row.names</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span>(<span class='st'>"G"</span>, <span class='fl'>1</span>:<span class='fl'>3</span>))

<span class='co'>## Compute alternative kinship matrix.</span>
<span class='no'>kin2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='kinship.html'>kinship</a></span>(<span class='kw'>X</span> <span class='kw'>=</span> <span class='no'>geno</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"astle"</span>)

<span class='co'>## Add covariates to previously created gData object and overwrite</span>
<span class='co'>## current kinship matrix by newly computed one.</span>
<span class='no'>gData2</span> <span class='kw'>&lt;-</span> <span class='fu'>createGData</span>(<span class='kw'>gData</span> <span class='kw'>=</span> <span class='no'>gData</span>, <span class='kw'>kin</span> <span class='kw'>=</span> <span class='no'>kin2</span>, <span class='kw'>covar</span> <span class='kw'>=</span> <span class='no'>covar</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: Existing kinship will be overwritten.</span></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Bart-Jan van Rossum, Willem Kruijer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


