<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="codeMarkers codes markers in a gData object and optionally
performs imputation of missing values as well.
The function performs the following steps:
replace strings in naStrings by NA.
remove genotypes with a fraction of missing values higher than
nMissGeno.
remove SNPs with a fraction of missing values higher than
nMiss.
recode SNPs to numerical values.
remove SNPs with a minor allele frequency lower than MAF.
optionally remove duplicate SNPs.
optionally impute missing values.
repeat steps 5. and 6. if missing values are imputed.

"><title>Code and impute markers — codeMarkers • statgenGWAS</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Code and impute markers — codeMarkers"><meta property="og:description" content="codeMarkers codes markers in a gData object and optionally
performs imputation of missing values as well.
The function performs the following steps:
replace strings in naStrings by NA.
remove genotypes with a fraction of missing values higher than
nMissGeno.
remove SNPs with a fraction of missing values higher than
nMiss.
recode SNPs to numerical values.
remove SNPs with a minor allele frequency lower than MAF.
optionally remove duplicate SNPs.
optionally impute missing values.
repeat steps 5. and 6. if missing values are imputed.

"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">statgenGWAS</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.9.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/index.html">Vignettes</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="nav-link" href="../news/index.html">
    <span class="fa fa-newspaper-o"></span>
     
    news
  </a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    functions
  </a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown--other-packages">
    <span class="fa fa-seedling"></span>
     
    other packages
  </a>
  <div class="dropdown-menu" aria-labelledby="dropdown--other-packages">
    <a class="external-link dropdown-item" href="https://biometris.github.io/statgenSTA">statgenSTA</a>
    <a class="external-link dropdown-item" href="https://biometris.github.io/statgenGxE">statgenGxE</a>
    <a class="external-link dropdown-item" href="https://biometris.github.io/statgenHTP">statgenHTP</a>
    <a class="external-link dropdown-item" href="https://biometris.github.io/statgenIBD">statgenIBD</a>
    <a class="external-link dropdown-item" href="https://biometris.github.io/statgenMPP">statgenMPP</a>
    <a class="external-link dropdown-item" href="https://biometris.github.io/LMMsolver">LMMsolver</a>
  </div>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/Biometris/statgenGWAS">
    <span class="fa fa-github fa-lg fab"></span>
     
    github
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Code and impute markers</h1>
      <small class="dont-index">Source: <a href="https://github.com/Biometris/statgenGWAS/blob/HEAD/R/codeMarkers.R" class="external-link"><code>R/codeMarkers.R</code></a></small>
      <div class="d-none name"><code>codeMarkers.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>codeMarkers</code> codes markers in a <code>gData</code> object and optionally
performs imputation of missing values as well.<br>
The function performs the following steps:<br></p><ol><li><p>replace strings in <code>naStrings</code> by <code>NA</code>.</p></li>
<li><p>remove genotypes with a fraction of missing values higher than
<code>nMissGeno</code>.</p></li>
<li><p>remove SNPs with a fraction of missing values higher than
<code>nMiss</code>.</p></li>
<li><p>recode SNPs to numerical values.</p></li>
<li><p>remove SNPs with a minor allele frequency lower than <code>MAF</code>.</p></li>
<li><p>optionally remove duplicate SNPs.</p></li>
<li><p>optionally impute missing values.</p></li>
<li><p>repeat steps 5. and 6. if missing values are imputed.</p></li>
</ol></div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">codeMarkers</span><span class="op">(</span></span>
<span>  <span class="va">gData</span>,</span>
<span>  refAll <span class="op">=</span> <span class="st">"minor"</span>,</span>
<span>  nMissGeno <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  nMiss <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  MAF <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  MAC <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  removeDuplicates <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  keep <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  impute <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  imputeType <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"random"</span>, <span class="st">"fixed"</span>, <span class="st">"beagle"</span><span class="op">)</span>,</span>
<span>  fixedValue <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  naStrings <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>gData</dt>
<dd><p>An object of class <code>gData</code> containing at least
<code>markers</code>.</p></dd>


<dt>refAll</dt>
<dd><p>A character string indicating the reference allele used when
recoding markers.<br>
If "minor", then the recoding is done using the minor allele as reference
allele. Alternatively a single character can be supplied as a reference
allele for the whole set of SNPs, or a character vector with a reference
allele per SNP.</p></dd>


<dt>nMissGeno</dt>
<dd><p>A numerical value between 0 and 1. Genotypes with a
fraction of missing values higher than <code>nMissGeno</code> will be removed.
Genotypes with only missing values will always be removed.</p></dd>


<dt>nMiss</dt>
<dd><p>A numerical value between 0 and 1. SNPs with a fraction of
missing values higher than <code>nMiss</code> will be removed. SNPs with only
missing values will always be removed.</p></dd>


<dt>MAF</dt>
<dd><p>A numerical value between 0 and 1. SNPs with a Minor Allele
Frequency (MAF) below this value will be removed. Only one of <code>MAF</code>
and <code>MAC</code> may be specified.</p></dd>


<dt>MAC</dt>
<dd><p>A numerical value. SNPs with Minor Allele Count (MAC) below this
value will be removed. Only one of <code>MAF</code> and <code>MAC</code> may be
specified.</p></dd>


<dt>removeDuplicates</dt>
<dd><p>Should duplicate SNPs be removed?</p></dd>


<dt>keep</dt>
<dd><p>A vector of SNPs that should never be removed in the whole
process.</p></dd>


<dt>impute</dt>
<dd><p>Should imputation of missing values be done?</p></dd>


<dt>imputeType</dt>
<dd><p>A character string indicating what kind of imputation of
values should be done.<br></p><ul><li><p>fixed - missing values will be replaced by a given fixed value.</p></li>
<li><p>random - missing values will be replaced by a random value calculated
using allele frequencies per SNP.</p></li>
<li><p>beagle - missing values will be imputed using beagle software, version
5.2. Beagle only accepts integers as map positions. If you use this option,
please cite the original papers in your publication (see references).</p></li>
</ul></dd>


<dt>fixedValue</dt>
<dd><p>A numerical value used for replacing missing values in
case <code>inputType</code> is fixed.</p></dd>


<dt>naStrings</dt>
<dd><p>A character vector of strings to be treated as NA.</p></dd>


<dt>verbose</dt>
<dd><p>Should a summary of the performed steps be printed?</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A copy of the input <code>gData</code> object with markers replaced by
coded and imputed markers.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>S R Browning and B L Browning (2007) Rapid and accurate haplotype
phasing and missing data inference for whole genome association studies by
use of localized haplotype clustering. Am J Hum Genet 81:1084-1097.
<a href="https://doi.org/10.1086/521987" class="external-link">doi:10.1086/521987</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## Create markers</span></span></span>
<span class="r-in"><span><span class="va">markers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span><span class="st">"AA"</span>,   <span class="st">"AB"</span>,   <span class="st">"AA"</span>,   <span class="st">"BB"</span>,   <span class="st">"BA"</span>,   <span class="st">"AB"</span>,   <span class="st">"AA"</span>,   <span class="st">"AA"</span>,   <span class="cn">NA</span>,  <span class="st">"AA"</span>,</span></span>
<span class="r-in"><span><span class="st">"AA"</span>,   <span class="st">"AA"</span>,   <span class="st">"BB"</span>,   <span class="st">"BB"</span>,   <span class="st">"AA"</span>,   <span class="st">"AA"</span>,   <span class="st">"BB"</span>,   <span class="st">"AA"</span>,   <span class="cn">NA</span>,  <span class="st">"AA"</span>,</span></span>
<span class="r-in"><span><span class="st">"AA"</span>,   <span class="st">"BA"</span>,   <span class="st">"AB"</span>,   <span class="st">"BB"</span>,   <span class="st">"AB"</span>,   <span class="st">"AB"</span>,   <span class="st">"AA"</span>,   <span class="st">"BB"</span>,   <span class="cn">NA</span>,  <span class="st">"AA"</span>,</span></span>
<span class="r-in"><span><span class="st">"AA"</span>,   <span class="st">"AA"</span>,   <span class="st">"BB"</span>,   <span class="st">"BB"</span>,   <span class="st">"AA"</span>,   <span class="st">"AA"</span>,   <span class="st">"AA"</span>,   <span class="st">"AA"</span>,   <span class="cn">NA</span>,  <span class="st">"AA"</span>,</span></span>
<span class="r-in"><span><span class="st">"AA"</span>,   <span class="st">"AA"</span>,   <span class="st">"BB"</span>,   <span class="st">"BB"</span>,   <span class="st">"AA"</span>,   <span class="st">"BB"</span>,   <span class="st">"BB"</span>,   <span class="st">"BB"</span>,  <span class="st">"AB"</span>, <span class="st">"AA"</span>,</span></span>
<span class="r-in"><span><span class="st">"AA"</span>,   <span class="st">"AA"</span>,   <span class="st">"BB"</span>,   <span class="st">"BB"</span>,   <span class="st">"AA"</span>,    <span class="cn">NA</span>,    <span class="st">"BB"</span>,   <span class="st">"AA"</span>,   <span class="cn">NA</span>,  <span class="st">"AA"</span>,</span></span>
<span class="r-in"><span><span class="st">"AB"</span>,   <span class="st">"AB"</span>,   <span class="st">"BB"</span>,   <span class="st">"BB"</span>,   <span class="st">"BB"</span>,   <span class="st">"AA"</span>,   <span class="st">"BB"</span>,   <span class="st">"BB"</span>,   <span class="cn">NA</span>,  <span class="st">"AB"</span>,</span></span>
<span class="r-in"><span><span class="st">"AA"</span>,   <span class="st">"AA"</span>,    <span class="cn">NA</span>,    <span class="st">"BB"</span>,    <span class="cn">NA</span>,    <span class="st">"AA"</span>,   <span class="st">"AA"</span>,   <span class="st">"AA"</span>,  <span class="st">"AA"</span>, <span class="st">"AA"</span>,</span></span>
<span class="r-in"><span><span class="st">"AA"</span>,    <span class="cn">NA</span>,     <span class="cn">NA</span>,    <span class="st">"BB"</span>,   <span class="st">"BB"</span>,   <span class="st">"BB"</span>,   <span class="st">"BB"</span>,   <span class="st">"BB"</span>,  <span class="st">"AA"</span>, <span class="st">"AA"</span>,</span></span>
<span class="r-in"><span><span class="st">"AA"</span>,    <span class="cn">NA</span>,    <span class="st">"AA"</span>,   <span class="st">"BB"</span>,   <span class="st">"BB"</span>,   <span class="st">"BB"</span>,   <span class="st">"AA"</span>,   <span class="st">"AA"</span>,   <span class="cn">NA</span>,  <span class="st">"AA"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>ncol <span class="op">=</span> <span class="fl">10</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span>, dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"IND"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>,</span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"SNP"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## create object of class 'gData'.</span></span></span>
<span class="r-in"><span><span class="va">gData</span> <span class="op">&lt;-</span> <span class="fu"><a href="gData.html">createGData</a></span><span class="op">(</span>geno <span class="op">=</span> <span class="va">markers</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Code markers by minor allele, no imputation.</span></span></span>
<span class="r-in"><span><span class="va">gDataCoded1</span> <span class="op">&lt;-</span> <span class="fu">codeMarkers</span><span class="op">(</span>gData <span class="op">=</span> <span class="va">gData</span>, impute <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Code markers by reference alleles, impute missings by fixed value.</span></span></span>
<span class="r-in"><span><span class="va">gDataCoded2</span> <span class="op">&lt;-</span> <span class="fu">codeMarkers</span><span class="op">(</span>gData <span class="op">=</span> <span class="va">gData</span>,</span></span>
<span class="r-in"><span>                           refAll <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span>, times <span class="op">=</span>  <span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                           impute <span class="op">=</span> <span class="cn">TRUE</span>, imputeType <span class="op">=</span> <span class="st">"fixed"</span>,</span></span>
<span class="r-in"><span>                           fixedValue <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Code markers by minor allele, impute by random value.</span></span></span>
<span class="r-in"><span><span class="va">gDataCoded3</span> <span class="op">&lt;-</span> <span class="fu">codeMarkers</span><span class="op">(</span>gData <span class="op">=</span> <span class="va">gData</span>, impute <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                           imputeType <span class="op">=</span> <span class="st">"random"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Bart-Jan van Rossum, Willem Kruijer.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

