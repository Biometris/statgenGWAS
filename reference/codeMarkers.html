<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Code and impute markers — codeMarkers • statgenGWAS</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Code and impute markers — codeMarkers" />
<meta property="og:description" content="codeMarkers codes markers in a gData object and optionally
performs imputation of missing values as well.
The function performs the following steps:
replace strings in naStrings by NA.
remove genotypes with a fraction of missing values higher than
nMissGeno.
remove SNPs with a fraction of missing values higher than
nMiss.
recode SNPs to numerical values.
remove SNPs with a minor allele frequency lower than MAF.
optionally remove duplicate SNPs.
optionally impute missing values.
repeat steps 5. and 6. if missing values are imputed.

" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">statgenGWAS</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../news/index.html">
    <span class="fa fa-newspaper-o"></span>
     
    news
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    functions
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-seedling"></span>
     
    other packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="https://biometris.github.io/statgenSTA">statgenSTA</a>
    </li>
    <li>
      <a href="https://biometris.github.io/statgenGxE">statgenGxE</a>
    </li>
    <li>
      <a href="https://biometris.github.io/statgenHTP">statgenHTP</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://github.com/Biometris/statgenGWAS">
    <span class="fa fa-github fa-lg fab"></span>
     
    github
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Code and impute markers</h1>
    <small class="dont-index">Source: <a href='https://github.com/Biometris/statgenGWAS/blob/master/R/codeMarkers.R'><code>R/codeMarkers.R</code></a></small>
    <div class="hidden name"><code>codeMarkers.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>codeMarkers</code> codes markers in a <code>gData</code> object and optionally
performs imputation of missing values as well.<br />
The function performs the following steps:<br /></p><ol>
<li><p>replace strings in <code>naStrings</code> by <code>NA</code>.</p></li>
<li><p>remove genotypes with a fraction of missing values higher than
<code>nMissGeno</code>.</p></li>
<li><p>remove SNPs with a fraction of missing values higher than
<code>nMiss</code>.</p></li>
<li><p>recode SNPs to numerical values.</p></li>
<li><p>remove SNPs with a minor allele frequency lower than <code>MAF</code>.</p></li>
<li><p>optionally remove duplicate SNPs.</p></li>
<li><p>optionally impute missing values.</p></li>
<li><p>repeat steps 5. and 6. if missing values are imputed.</p></li>
</ol>

    </div>

    <pre class="usage"><span class='fu'>codeMarkers</span><span class='op'>(</span>
  <span class='va'>gData</span>,
  refAll <span class='op'>=</span> <span class='st'>"minor"</span>,
  nMissGeno <span class='op'>=</span> <span class='fl'>1</span>,
  nMiss <span class='op'>=</span> <span class='fl'>1</span>,
  MAF <span class='op'>=</span> <span class='cn'>NULL</span>,
  MAC <span class='op'>=</span> <span class='cn'>NULL</span>,
  removeDuplicates <span class='op'>=</span> <span class='cn'>TRUE</span>,
  keep <span class='op'>=</span> <span class='cn'>NULL</span>,
  impute <span class='op'>=</span> <span class='cn'>TRUE</span>,
  imputeType <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"random"</span>, <span class='st'>"fixed"</span>, <span class='st'>"beagle"</span><span class='op'>)</span>,
  fixedValue <span class='op'>=</span> <span class='cn'>NULL</span>,
  naStrings <span class='op'>=</span> <span class='cn'>NA</span>,
  verbose <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>gData</th>
      <td><p>An object of class <code>gData</code> containing at least
<code>markers</code>.</p></td>
    </tr>
    <tr>
      <th>refAll</th>
      <td><p>A character string indicating the reference allele used when
recoding markers.<br />
If "minor", then the recoding is done using the minor allele as reference
allele. Alternatively a single character can be supplied as a reference
allele for the whole set of SNPs, or a character vector with a reference
allele per SNP.</p></td>
    </tr>
    <tr>
      <th>nMissGeno</th>
      <td><p>A numerical value between 0 and 1. Genotypes with a
fraction of missing values higher than <code>nMissGeno</code> will be removed.
Genotypes with only missing values will always be removed.</p></td>
    </tr>
    <tr>
      <th>nMiss</th>
      <td><p>A numerical value between 0 and 1. SNPs with a fraction of
missing values higher than <code>nMiss</code> will be removed. SNPs with only
missing values will always be removed.</p></td>
    </tr>
    <tr>
      <th>MAF</th>
      <td><p>A numerical value between 0 and 1. SNPs with a Minor Allele
Frequency (MAF) below this value will be removed. Only one of <code>MAF</code>
and <code>MAC</code> may be specified.</p></td>
    </tr>
    <tr>
      <th>MAC</th>
      <td><p>A numerical value. SNPs with Minor Allele Count (MAC) below this
value will be removed. Only one of <code>MAF</code> and <code>MAC</code> may be
specified.</p></td>
    </tr>
    <tr>
      <th>removeDuplicates</th>
      <td><p>Should duplicate SNPs be removed?</p></td>
    </tr>
    <tr>
      <th>keep</th>
      <td><p>A vector of SNPs that should never be removed in the whole
process.</p></td>
    </tr>
    <tr>
      <th>impute</th>
      <td><p>Should imputation of missing values be done?</p></td>
    </tr>
    <tr>
      <th>imputeType</th>
      <td><p>A character string indicating what kind of imputation of
values should be done.<br /></p><ul>
<li><p>fixed - missing values will be replaced by a given fixed value.</p></li>
<li><p>random - missing values will be replaced by a random value calculated
using allele frequencies per SNP.</p></li>
<li><p>beagle - missing values will be imputed using beagle software, version
5.2. Beagle only accepts integers as map positions. If you use this option,
please cite the original papers in your publication (see references).</p></li>
</ul></td>
    </tr>
    <tr>
      <th>fixedValue</th>
      <td><p>A numerical value used for replacing missing values in
case <code>inputType</code> is fixed.</p></td>
    </tr>
    <tr>
      <th>naStrings</th>
      <td><p>A character vector of strings to be treated as NA.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>Should a summary of the performed steps be printed?</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A copy of the input <code>gData</code> object with markers replaced by
coded and imputed markers.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>S R Browning and B L Browning (2007) Rapid and accurate haplotype
phasing and missing data inference for whole genome association studies by
use of localized haplotype clustering. Am J Hum Genet 81:1084-1097.
doi: <a href='https://doi.org/10.1086/521987'>10.1086/521987</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>## Create markers</span>
<span class='va'>markers</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>
<span class='st'>"AA"</span>,   <span class='st'>"AB"</span>,   <span class='st'>"AA"</span>,   <span class='st'>"BB"</span>,   <span class='st'>"BA"</span>,   <span class='st'>"AB"</span>,   <span class='st'>"AA"</span>,   <span class='st'>"AA"</span>,   <span class='cn'>NA</span>,  <span class='st'>"AA"</span>,
<span class='st'>"AA"</span>,   <span class='st'>"AA"</span>,   <span class='st'>"BB"</span>,   <span class='st'>"BB"</span>,   <span class='st'>"AA"</span>,   <span class='st'>"AA"</span>,   <span class='st'>"BB"</span>,   <span class='st'>"AA"</span>,   <span class='cn'>NA</span>,  <span class='st'>"AA"</span>,
<span class='st'>"AA"</span>,   <span class='st'>"BA"</span>,   <span class='st'>"AB"</span>,   <span class='st'>"BB"</span>,   <span class='st'>"AB"</span>,   <span class='st'>"AB"</span>,   <span class='st'>"AA"</span>,   <span class='st'>"BB"</span>,   <span class='cn'>NA</span>,  <span class='st'>"AA"</span>,
<span class='st'>"AA"</span>,   <span class='st'>"AA"</span>,   <span class='st'>"BB"</span>,   <span class='st'>"BB"</span>,   <span class='st'>"AA"</span>,   <span class='st'>"AA"</span>,   <span class='st'>"AA"</span>,   <span class='st'>"AA"</span>,   <span class='cn'>NA</span>,  <span class='st'>"AA"</span>,
<span class='st'>"AA"</span>,   <span class='st'>"AA"</span>,   <span class='st'>"BB"</span>,   <span class='st'>"BB"</span>,   <span class='st'>"AA"</span>,   <span class='st'>"BB"</span>,   <span class='st'>"BB"</span>,   <span class='st'>"BB"</span>,  <span class='st'>"AB"</span>, <span class='st'>"AA"</span>,
<span class='st'>"AA"</span>,   <span class='st'>"AA"</span>,   <span class='st'>"BB"</span>,   <span class='st'>"BB"</span>,   <span class='st'>"AA"</span>,    <span class='cn'>NA</span>,    <span class='st'>"BB"</span>,   <span class='st'>"AA"</span>,   <span class='cn'>NA</span>,  <span class='st'>"AA"</span>,
<span class='st'>"AB"</span>,   <span class='st'>"AB"</span>,   <span class='st'>"BB"</span>,   <span class='st'>"BB"</span>,   <span class='st'>"BB"</span>,   <span class='st'>"AA"</span>,   <span class='st'>"BB"</span>,   <span class='st'>"BB"</span>,   <span class='cn'>NA</span>,  <span class='st'>"AB"</span>,
<span class='st'>"AA"</span>,   <span class='st'>"AA"</span>,    <span class='cn'>NA</span>,    <span class='st'>"BB"</span>,    <span class='cn'>NA</span>,    <span class='st'>"AA"</span>,   <span class='st'>"AA"</span>,   <span class='st'>"AA"</span>,  <span class='st'>"AA"</span>, <span class='st'>"AA"</span>,
<span class='st'>"AA"</span>,    <span class='cn'>NA</span>,     <span class='cn'>NA</span>,    <span class='st'>"BB"</span>,   <span class='st'>"BB"</span>,   <span class='st'>"BB"</span>,   <span class='st'>"BB"</span>,   <span class='st'>"BB"</span>,  <span class='st'>"AA"</span>, <span class='st'>"AA"</span>,
<span class='st'>"AA"</span>,    <span class='cn'>NA</span>,    <span class='st'>"AA"</span>,   <span class='st'>"BB"</span>,   <span class='st'>"BB"</span>,   <span class='st'>"BB"</span>,   <span class='st'>"AA"</span>,   <span class='st'>"AA"</span>,   <span class='cn'>NA</span>,  <span class='st'>"AA"</span><span class='op'>)</span>,
ncol <span class='op'>=</span> <span class='fl'>10</span>, byrow <span class='op'>=</span> <span class='cn'>TRUE</span>, dimnames <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"IND"</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>10</span><span class='op'>)</span>,
<span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"SNP"</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>10</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>## create object of class 'gData'.</span>
<span class='va'>gData</span> <span class='op'>&lt;-</span> <span class='fu'><a href='gData.html'>createGData</a></span><span class='op'>(</span>geno <span class='op'>=</span> <span class='va'>markers</span><span class='op'>)</span>

<span class='co'>## Code markers by minor allele, no imputation.</span>
<span class='va'>gDataCoded1</span> <span class='op'>&lt;-</span> <span class='fu'>codeMarkers</span><span class='op'>(</span>gData <span class='op'>=</span> <span class='va'>gData</span>, impute <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>

<span class='co'>## Code markers by reference alleles, impute missings by fixed value.</span>
<span class='va'>gDataCoded2</span> <span class='op'>&lt;-</span> <span class='fu'>codeMarkers</span><span class='op'>(</span>gData <span class='op'>=</span> <span class='va'>gData</span>,
                           refAll <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"A"</span>, <span class='st'>"B"</span><span class='op'>)</span>, times <span class='op'>=</span>  <span class='fl'>5</span><span class='op'>)</span>,
                           impute <span class='op'>=</span> <span class='cn'>TRUE</span>, imputeType <span class='op'>=</span> <span class='st'>"fixed"</span>,
                           fixedValue <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>

<span class='co'>## Code markers by minor allele, impute by random value.</span>
<span class='va'>gDataCoded3</span> <span class='op'>&lt;-</span> <span class='fu'>codeMarkers</span><span class='op'>(</span>gData <span class='op'>=</span> <span class='va'>gData</span>, impute <span class='op'>=</span> <span class='cn'>TRUE</span>,
                           imputeType <span class='op'>=</span> <span class='st'>"random"</span><span class='op'>)</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Bart-Jan van Rossum, Willem Kruijer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


